/*
 * Blueprint v0.2 (github.com/nathanborror/blueprint)
 * Copyright 2015 Nathan Borror
 * Distributed under the New BSD license.
 */
var Cell=React.createClass({displayName:"Cell",render:function(){return React.createElement("div",{className:"bp-cell",onClick:this.props.onClick},this.props.children)}});var Section=React.createClass({displayName:"Section",render:function(){return React.createElement("div",{className:"bp-section"},this.props.title)}});var Collection=React.createClass({displayName:"Collection",render:function(){return React.createElement("div",{className:"bp-collection"},this.props.children)}});var UIContextMenuNotification=1e3;var ContextItem=React.createClass({displayName:"ContextItem",render:function(){return React.createElement("div",{className:"bp-context-item",onClick:this.props.onClick},this.props.children)}});var ContextMenu=React.createClass({displayName:"ContextMenu",defaults:{origin:{left:-1e3,top:-1e3},wide:false,autoselect:false},getInitialState:function(){return{items:[],options:this.defaults}},componentDidMount:function(){this.setState({items:[],options:this.defaults});this.props.notifications.addObserver(UIContextMenuNotification,this.handleDisplay)},handleDisplay:function(dispatch){var options=_.defaults(dispatch.options,this.defaults);if(dispatch.origin===null){this.setState({items:[],options:options});return}var menuWidth=this.getDOMNode().clientWidth;var menuHeight=this.getDOMNode().clientHeight;var left=options.origin.left-window.scrollX;var top=options.origin.top-window.scrollY;if(top+menuHeight>window.innerHeight){top=top-menuHeight}if(left+menuWidth>window.innerWidth){left=left-menuWidth}options.origin={left:left,top:top};this.setState({items:dispatch.items,options:options})},render:function(){var cx=React.addons.classSet;var classes=cx({"bp-context-menu":true,"bp-context-menu-wide":this.state.options.wide});var items=this.state.items.map(function(item){return React.createElement(ContextItem,{onClick:item.onClick},item.title)});return React.createElement("div",{className:classes,style:this.state.options.origin},items)}});var FormUtil={cleanedData:function(refs){var data={};for(ref in refs){if(typeof refs[ref].value==="function"){data[ref]=refs[ref].value()}else{data[ref]=refs[ref].getDOMNode().value.trim()}}return data}};var Form=React.createClass({displayName:"Form",render:function(){return React.createElement("div",{className:"bp-form"},this.props.children)}});var Field=React.createClass({displayName:"Field",render:function(){if(this.props.multiline){return React.createElement("textarea",{ref:this.props.ref,placeholder:this.props.placeholder,value:this.props.children})}return React.createElement("input",{type:"text",ref:this.props.ref,placeholder:this.props.placeholder,value:this.props.children})}});var Button=React.createClass({displayName:"Button",render:function(){return React.createElement("div",{className:"bp-button",onClick:this.props.onClick},this.props.children)}});var TypeaheadResult=React.createClass({displayName:"TypeaheadResult",handleClick:function(){this.props.onClick(this.props.identifier,this.props.children)},render:function(){return React.createElement("div",{className:"bp-typeahead-result",onClick:this.handleClick},this.props.children)}});var Typeahead=React.createClass({displayName:"Typeahead",defaults:{url:"/search",multiselect:false,label:function(item){return item.title},identifier:function(item){return item.key},data:function(data){return data}},value:function(){return this.state.identifier},getInitialState:function(){return{data:[],options:this.defaults,query:"",identifier:""}},componentDidMount:function(){this.state.options=_.defaults(this.props.options,this.defaults);this.setState(this.state)},handleChange:function(e){this.state.query=e.target.value;if(this.state.query===""){this.state.data=[];this.setState(this.state);return}$.get(this.state.options.url,{q:this.state.query}).done(function(data){this.state.data=this.state.options.data(data);this.setState(this.state)}.bind(this))},handleClick:function(identifier,label){this.state.query=label;this.state.identifier=identifier;this.state.data=[];this.setState(this.state)},handleClear:function(){this.state.identifier="";this.state.query="";this.setState(this.state)},handleKeyDown:function(e){if(e.keyCode===13){var result=this.state.data[0];if(result!==undefined){var identifier=this.state.options.identifier(result);var label=this.state.options.label(result);this.handleClick(identifier,label)}}},render:function(){var cx=React.addons.classSet;var classes=cx({"bp-typeahead":true,"bp-typeahead-selected":this.state.identifier!==""});var results=this.state.data.map(function(obj){var identifier=this.state.options.identifier(obj);var label=this.state.options.label(obj);return React.createElement(TypeaheadResult,{identifier:identifier,onClick:this.handleClick},label)}.bind(this));return React.createElement("div",{className:classes},React.createElement("div",{className:"bp-typeahead-clear",onClick:this.handleClear}),React.createElement("input",{type:"type",ref:"query",onChange:this.handleChange,onKeyDown:this.handleKeyDown,placeholder:this.props.placeholder,value:this.state.query}),React.createElement("div",{className:"bp-typeahead-results"},results))}});var MentionField=React.createClass({displayName:"MentionField",clearSelectAll:function(){if(this.state.selectAll){this.state.selectAll=false;this.setState(this.state)}},getInitialState:function(){return{value:"",selectAll:false}},componentDidMount:function(){this.setState({value:"",selectAll:false})},handleKeyDown:function(e){switch(e.keyCode){case 32:this.clearSelectAll();break;case 8:if(this.state.selectAll){this.state.selectAll=false;this.state.value="";this.setState(this.state)}else{this.state.value=this.state.value.slice(0,-1);this.setState(this.state)}break;case 65:if(e.metaKey){this.state.selectAll=true;this.setState(this.state);break}default:this.clearSelectAll()}},handleChange:function(e){var input=this.refs.text.getDOMNode();this.state.value=this.state.value+e.target.value;this.setState(this.state)},handleFocus:function(e){var input=this.refs.text.getDOMNode();input.focus()},render:function(){var cx=React.addons.classSet;var classes=cx({"bp-token":true,"bp-token-select-all":this.state.selectAll});var results=this.state.value.match(/(@\w+?)+/);if(results){}else{}return React.createElement("div",{className:classes,onClick:this.handleFocus},React.createElement("div",{className:"bp-token-value"},this.state.value),React.createElement("input",{className:"bp-token-input",type:"text",ref:"text",value:"",onChange:this.handleChange,onKeyDown:this.handleKeyDown}))}});var UIModalNotification=1001;var Modal=React.createClass({displayName:"Modal",defaults:{visible:false,contents:null},getInitialState:function(){this.props.notifications.addObserver(UIModalNotification,this.handleDisplay);return{visible:false,contents:null}},handleDisplay:function(dispatch){var state=_.defaults(dispatch,this.defaults);this.setState(state)},handleDismiss:function(){this.state.visible=false;this.setState(this.state)},handleIgnore:function(e){e.stopPropagation()},render:function(){var cx=React.addons.classSet;var classes=cx({"bp-modal-mask":true,"bp-modal-mask-active":this.state.visible});return React.createElement("div",{className:classes,onClick:this.handleDismiss},React.createElement("div",{className:"bp-modal",onClick:this.handleIgnore},this.state.contents))}});var NotificationCenter=function(){};NotificationCenter.prototype._observers=[];NotificationCenter.prototype._promises=[];NotificationCenter.prototype.addObserver=function(type,callback){this._observers.push({type:type,callback:callback});return this._observers.length-1};NotificationCenter.prototype.post=function(type,payload){var resolves=[];var rejects=[];this._promises=this._observers.map(function(obj,i){if(type===obj.type){return new Promise(function(resolve,reject){resolves[i]=resolve;rejects[i]=reject})}});this._observers.forEach(function(obj,i){if(type===obj.type){Promise.resolve(obj.callback(payload)).then(function(){resolves[i](payload)},function(){rejects[i](new Error("Dispatcher callback unsuccessful"))})}});this._promises=[]};var Stack=React.createClass({displayName:"Stack",render:function(){var classes=this.props.className?this.props.className:"";var styles={display:this.props.horizontal?"-webkit-flex":"block",WebkitJustifyContent:"space-between"};return React.createElement("div",{className:"bp-stack "+classes,style:styles},this.props.children)}});var Group=React.createClass({displayName:"Group",defaults:{grow:1,shrink:1,basis:""},render:function(){var classes=this.props.className?this.props.className:"";var options=_.defaults(this.props.options,this.defaults);var styles={WebkitFlex:options.grow+" "+options.shrink+" "+options.basis,WebkitOrder:this.props.order};return React.createElement("div",{className:"bp-group "+classes,style:styles},this.props.children)}});
